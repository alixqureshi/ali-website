<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Personal OS</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Instrument+Serif:ital@0;1&family=JetBrains+Mono:wght@300;400;500&display=swap" rel="stylesheet">
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            'surface':       '#0a0a0a',
            'surface-alt':   '#0f0f0f',
            'surface-card':  '#111111',
            'surface-hover': '#161616',
            'off-white':     '#f5f5f0',
            'muted':         '#6b6b6b',
            'border':        '#1a1a1a',
            'gold':          '#c9a227',
            'gold-dim':      'rgba(201,162,39,0.15)',
          },
          fontFamily: {
            'serif':  ['Instrument Serif', 'Georgia', 'serif'],
            'mono':   ['JetBrains Mono', 'monospace'],
          },
        },
      },
    }
  </script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    html, body { height: 100%; overflow: hidden; }
    body { font-family: 'JetBrains Mono', monospace; background: #0a0a0a; color: #f5f5f0; }
    ::selection { background: #f5f5f0; color: #0a0a0a; }

    /* Custom scrollbar */
    ::-webkit-scrollbar { width: 6px; }
    ::-webkit-scrollbar-track { background: transparent; }
    ::-webkit-scrollbar-thumb { background: #1a1a1a; }
    ::-webkit-scrollbar-thumb:hover { background: #2a2a2a; }

    /* Sidebar transition */
    #sidebar { transition: transform 0.3s ease; }

    /* Card hover */
    .tool-card { transition: border-color 0.3s ease; }
    .tool-card:hover { border-color: rgba(201, 162, 39, 0.3); }

    /* Iframe fade-in */
    #tool-frame { transition: opacity 0.3s ease; }
    #tool-frame.loading { opacity: 0; }

    /* Nav item hover */
    .nav-item { transition: all 0.2s ease; }

    /* Active prayer highlight */
    .prayer-time.active { color: #c9a227; }
    .prayer-time.passed { color: #3a3a3a; }

    /* Fade in animation */
    @keyframes fadeUp {
      from { opacity: 0; transform: translateY(12px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .fade-in { animation: fadeUp 0.5s ease forwards; }
    .fade-in-delay-1 { animation-delay: 0.05s; opacity: 0; }
    .fade-in-delay-2 { animation-delay: 0.1s; opacity: 0; }
    .fade-in-delay-3 { animation-delay: 0.15s; opacity: 0; }
    .fade-in-delay-4 { animation-delay: 0.2s; opacity: 0; }
    .fade-in-delay-5 { animation-delay: 0.25s; opacity: 0; }
    .fade-in-delay-6 { animation-delay: 0.3s; opacity: 0; }
  </style>
</head>
<body class="bg-surface text-off-white">

  <!-- Mobile hamburger -->
  <button id="mobile-toggle" class="fixed top-4 left-4 z-50 md:hidden p-2 bg-surface-alt border border-border hover:border-muted transition-colors">
    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round">
      <line x1="3" y1="6" x2="21" y2="6"/>
      <line x1="3" y1="12" x2="21" y2="12"/>
      <line x1="3" y1="18" x2="21" y2="18"/>
    </svg>
  </button>

  <!-- Mobile backdrop -->
  <div id="sidebar-backdrop" class="fixed inset-0 bg-black/50 z-30 hidden md:hidden"></div>

  <!-- Sidebar -->
  <aside id="sidebar" class="fixed left-0 top-0 h-screen w-[240px] bg-surface-alt border-r border-border flex flex-col z-40 -translate-x-full md:translate-x-0">

    <!-- Brand -->
    <div class="h-14 flex items-center px-6 border-b border-border">
      <span class="text-[11px] uppercase tracking-[0.2em] text-muted font-mono">Personal OS</span>
    </div>

    <!-- Nav -->
    <nav class="flex-1 py-4 px-3 overflow-y-auto">

      <!-- Dashboard -->
      <a href="#home" class="nav-item flex items-center gap-3 px-3 py-2.5 text-[13px] text-muted hover:text-off-white cursor-pointer" data-route="home">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
          <rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/>
        </svg>
        <span>Dashboard</span>
      </a>

      <!-- Separator -->
      <div class="my-3 mx-3 border-t border-border"></div>

      <!-- Tools section label -->
      <div class="px-3 pt-1 pb-3">
        <span class="text-[10px] uppercase tracking-[0.2em] text-muted/60">Tools</span>
      </div>

      <!-- Design Gallery -->
      <a href="#design-gallery" class="nav-item flex items-center gap-3 px-3 py-2.5 text-[13px] text-muted hover:text-off-white cursor-pointer" data-route="design-gallery">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="13.5" cy="6.5" r="2.5"/><circle cx="17.5" cy="15.5" r="2.5"/><circle cx="8.5" cy="15.5" r="2.5"/><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2"/>
        </svg>
        <span>Design Gallery</span>
      </a>

      <!-- Cover Builder -->
      <a href="#cover-builder" class="nav-item flex items-center gap-3 px-3 py-2.5 text-[13px] text-muted hover:text-off-white cursor-pointer" data-route="cover-builder">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
          <rect x="3" y="3" width="18" height="18" rx="2"/><circle cx="8.5" cy="8.5" r="1.5"/><path d="m21 15-5-5L5 21"/>
        </svg>
        <span>Cover Builder</span>
      </a>

      <!-- Separator -->
      <div class="my-3 mx-3 border-t border-border"></div>

      <!-- Collateral section label -->
      <div class="px-3 pt-1 pb-3">
        <span class="text-[10px] uppercase tracking-[0.2em] text-muted/60">Collateral</span>
      </div>

      <!-- Proposal -->
      <a href="#proposal" class="nav-item flex items-center gap-3 px-3 py-2.5 text-[13px] text-muted hover:text-off-white cursor-pointer" data-route="proposal">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8Z"/><path d="M14 2v6h6"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><line x1="10" y1="9" x2="8" y2="9"/>
        </svg>
        <span>Proposal</span>
      </a>

      <!-- Pitch Deck -->
      <a href="#pitch-deck" class="nav-item flex items-center gap-3 px-3 py-2.5 text-[13px] text-muted hover:text-off-white cursor-pointer" data-route="pitch-deck">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
          <path d="M2 3h20v14H2z"/><line x1="12" y1="17" x2="12" y2="21"/><line x1="8" y1="21" x2="16" y2="21"/>
        </svg>
        <span>Pitch Deck</span>
      </a>

      <!-- Case Study -->
      <a href="#case-study" class="nav-item flex items-center gap-3 px-3 py-2.5 text-[13px] text-muted hover:text-off-white cursor-pointer" data-route="case-study">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
          <line x1="18" y1="20" x2="18" y2="10"/><line x1="12" y1="20" x2="12" y2="4"/><line x1="6" y1="20" x2="6" y2="14"/><line x1="2" y1="20" x2="22" y2="20"/>
        </svg>
        <span>Case Study</span>
      </a>

      <!-- One Pager -->
      <a href="#one-pager" class="nav-item flex items-center gap-3 px-3 py-2.5 text-[13px] text-muted hover:text-off-white cursor-pointer" data-route="one-pager">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8Z"/><path d="M14 2v6h6"/>
        </svg>
        <span>One Pager</span>
      </a>

    </nav>

    <!-- Footer -->
    <div class="px-6 py-4 border-t border-border flex items-center gap-3">
      <div class="w-7 h-7 bg-surface-card border border-border flex items-center justify-center text-[10px] text-muted uppercase tracking-wider">A</div>
      <span class="text-[11px] text-muted font-mono">Ali Qureshi</span>
    </div>

  </aside>

  <!-- Main Content -->
  <main id="main-content" class="md:ml-[240px] h-screen overflow-hidden">

    <!-- Home Dashboard -->
    <div id="view-home" class="h-full overflow-y-auto p-8 md:p-12">

      <!-- Header -->
      <div class="flex flex-col md:flex-row md:items-start justify-between mb-12 fade-in gap-6">
        <div>
          <h1 class="font-serif text-3xl md:text-4xl mb-2" id="greeting">Good morning</h1>
          <p class="text-[13px] text-muted">Your tools, one place.</p>
        </div>
        <div class="flex flex-col items-start md:items-end gap-3 shrink-0">
          <!-- Date & Time -->
          <div class="text-right">
            <p class="text-[11px] uppercase tracking-[0.15em] text-muted" id="current-date"></p>
            <p class="font-serif text-2xl text-off-white mt-1" id="current-time"></p>
          </div>
          <!-- Weather -->
          <div id="weather-widget" class="flex items-center gap-2 text-[12px] text-muted">
            <span id="weather-icon">--</span>
            <span id="weather-temp">--</span>
            <span class="text-muted/40">Â·</span>
            <span id="weather-desc">Loading...</span>
          </div>
          <!-- Prayer Times -->
          <div id="prayer-widget" class="flex flex-wrap items-center gap-x-3 gap-y-1 text-[11px]">
            <span class="text-muted/40 uppercase tracking-[0.15em] text-[10px]">Salah</span>
            <span class="prayer-time text-muted" data-prayer="Fajr">--</span>
            <span class="prayer-time text-muted" data-prayer="Dhuhr">--</span>
            <span class="prayer-time text-muted" data-prayer="Asr">--</span>
            <span class="prayer-time text-muted" data-prayer="Maghrib">--</span>
            <span class="prayer-time text-muted" data-prayer="Isha">--</span>
          </div>
        </div>
      </div>

      <!-- Tools Section -->
      <div class="mb-10">
        <p class="text-[10px] uppercase tracking-[0.2em] text-muted/60 mb-6 fade-in fade-in-delay-1">Tools</p>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">

          <!-- Design Gallery Card -->
          <a href="#design-gallery" class="tool-card block bg-surface-card border border-border p-6 cursor-pointer fade-in fade-in-delay-1">
            <div class="flex items-center gap-3 mb-4">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#6b6b6b" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="13.5" cy="6.5" r="2.5"/><circle cx="17.5" cy="15.5" r="2.5"/><circle cx="8.5" cy="15.5" r="2.5"/><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2"/>
              </svg>
              <h3 class="font-serif text-lg text-off-white">Design Gallery</h3>
            </div>
            <p class="text-[12px] text-muted leading-relaxed mb-6">18 design directions, 48 real-world references. Browse by category, style, or technique.</p>
            <span class="text-[10px] uppercase tracking-[0.15em] text-gold">Open â†’</span>
          </a>

          <!-- Cover Builder Card -->
          <a href="#cover-builder" class="tool-card block bg-surface-card border border-border p-6 cursor-pointer fade-in fade-in-delay-2">
            <div class="flex items-center gap-3 mb-4">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#6b6b6b" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                <rect x="3" y="3" width="18" height="18" rx="2"/><circle cx="8.5" cy="8.5" r="1.5"/><path d="m21 15-5-5L5 21"/>
              </svg>
              <h3 class="font-serif text-lg text-off-white">Cover Builder</h3>
            </div>
            <p class="text-[12px] text-muted leading-relaxed mb-6">Twitter/X cover image generator with real-time preview and PNG export.</p>
            <span class="text-[10px] uppercase tracking-[0.15em] text-gold">Open â†’</span>
          </a>

          <!-- Spacer for alignment (hidden on mobile) -->
          <div class="hidden lg:block"></div>

        </div>
      </div>

      <!-- Collateral Section -->
      <div>
        <p class="text-[10px] uppercase tracking-[0.2em] text-muted/60 mb-6 fade-in fade-in-delay-3">Collateral</p>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">

          <!-- Proposal Card -->
          <a href="#proposal" class="tool-card block bg-surface-card border border-border p-6 cursor-pointer fade-in fade-in-delay-3">
            <div class="flex items-center gap-3 mb-3">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#6b6b6b" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8Z"/><path d="M14 2v6h6"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><line x1="10" y1="9" x2="8" y2="9"/>
              </svg>
              <h3 class="font-serif text-base text-off-white">Proposal</h3>
            </div>
            <p class="text-[11px] text-muted leading-relaxed mb-4">Multi-page A4 proposal with print-ready layout.</p>
            <span class="text-[10px] uppercase tracking-[0.15em] text-gold">Open â†’</span>
          </a>

          <!-- Pitch Deck Card -->
          <a href="#pitch-deck" class="tool-card block bg-surface-card border border-border p-6 cursor-pointer fade-in fade-in-delay-4">
            <div class="flex items-center gap-3 mb-3">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#6b6b6b" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                <path d="M2 3h20v14H2z"/><line x1="12" y1="17" x2="12" y2="21"/><line x1="8" y1="21" x2="16" y2="21"/>
              </svg>
              <h3 class="font-serif text-base text-off-white">Pitch Deck</h3>
            </div>
            <p class="text-[11px] text-muted leading-relaxed mb-4">Slide deck with arrow-key navigation.</p>
            <span class="text-[10px] uppercase tracking-[0.15em] text-gold">Open â†’</span>
          </a>

          <!-- Case Study Card -->
          <a href="#case-study" class="tool-card block bg-surface-card border border-border p-6 cursor-pointer fade-in fade-in-delay-5">
            <div class="flex items-center gap-3 mb-3">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#6b6b6b" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                <line x1="18" y1="20" x2="18" y2="10"/><line x1="12" y1="20" x2="12" y2="4"/><line x1="6" y1="20" x2="6" y2="14"/><line x1="2" y1="20" x2="22" y2="20"/>
              </svg>
              <h3 class="font-serif text-base text-off-white">Case Study</h3>
            </div>
            <p class="text-[11px] text-muted leading-relaxed mb-4">A4 case study document template.</p>
            <span class="text-[10px] uppercase tracking-[0.15em] text-gold">Open â†’</span>
          </a>

          <!-- One Pager Card -->
          <a href="#one-pager" class="tool-card block bg-surface-card border border-border p-6 cursor-pointer fade-in fade-in-delay-6">
            <div class="flex items-center gap-3 mb-3">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#6b6b6b" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8Z"/><path d="M14 2v6h6"/>
              </svg>
              <h3 class="font-serif text-base text-off-white">One Pager</h3>
            </div>
            <p class="text-[11px] text-muted leading-relaxed mb-4">Single A4 brand overview sheet.</p>
            <span class="text-[10px] uppercase tracking-[0.15em] text-gold">Open â†’</span>
          </a>

        </div>
      </div>

      <!-- Footer spacer -->
      <div class="h-12"></div>

    </div>

    <!-- Tool iframe -->
    <iframe id="tool-frame" class="hidden w-full h-full border-0" src="" sandbox="allow-scripts allow-same-origin allow-popups allow-downloads allow-forms"></iframe>

    <!-- Loading state -->
    <div id="loading-state" class="hidden absolute inset-0 md:left-[240px] flex items-center justify-center bg-surface">
      <span class="text-[11px] uppercase tracking-[0.2em] text-muted animate-pulse">Loading...</span>
    </div>

  </main>

  <script>
    // â”€â”€ Route Map â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    const routes = {
      'home':           { type: 'dashboard' },
      'design-gallery': { type: 'iframe', src: 'tools/design-gallery/index.html', title: 'Design Gallery' },
      'cover-builder':  { type: 'iframe', src: 'tools/cover-builder/index.html', title: 'Cover Builder' },
      'proposal':       { type: 'iframe', src: 'tools/collateral/proposal.html', title: 'Proposal' },
      'pitch-deck':     { type: 'iframe', src: 'tools/collateral/pitch-deck.html', title: 'Pitch Deck' },
      'case-study':     { type: 'iframe', src: 'tools/collateral/case-study.html', title: 'Case Study' },
      'one-pager':      { type: 'iframe', src: 'tools/collateral/one-pager.html', title: 'One Pager' },
    };

    // â”€â”€ Elements â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    const homeView     = document.getElementById('view-home');
    const toolFrame    = document.getElementById('tool-frame');
    const loadingState = document.getElementById('loading-state');
    const sidebar      = document.getElementById('sidebar');
    const backdrop     = document.getElementById('sidebar-backdrop');
    const mobileToggle = document.getElementById('mobile-toggle');

    // â”€â”€ Navigation â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function navigate() {
      const hash  = window.location.hash.slice(1) || 'home';
      const route = routes[hash];

      // Update sidebar active state
      document.querySelectorAll('.nav-item').forEach(item => {
        const isActive = item.dataset.route === hash;
        if (isActive) {
          item.classList.add('text-gold', 'bg-gold-dim', 'border-l-2', 'border-l-gold');
          item.classList.remove('text-muted');
        } else {
          item.classList.remove('text-gold', 'bg-gold-dim', 'border-l-2', 'border-l-gold');
          item.classList.add('text-muted');
        }
      });

      // Close mobile sidebar
      closeMobileSidebar();

      if (!route || route.type === 'dashboard') {
        // Show home
        homeView.classList.remove('hidden');
        toolFrame.classList.add('hidden');
        loadingState.classList.add('hidden');
        toolFrame.src = '';
        document.title = 'Personal OS';
      } else {
        // Show tool in iframe
        homeView.classList.add('hidden');
        loadingState.classList.remove('hidden');
        toolFrame.classList.add('hidden', 'loading');

        toolFrame.src = route.src;
        document.title = `${route.title} â€” Personal OS`;

        toolFrame.onload = () => {
          loadingState.classList.add('hidden');
          toolFrame.classList.remove('hidden', 'loading');
          // Focus iframe for keyboard events (pitch deck arrows, etc.)
          toolFrame.contentWindow.focus();
        };
      }
    }

    // â”€â”€ Mobile Sidebar â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function openMobileSidebar() {
      sidebar.classList.remove('-translate-x-full');
      backdrop.classList.remove('hidden');
    }

    function closeMobileSidebar() {
      if (window.innerWidth < 768) {
        sidebar.classList.add('-translate-x-full');
        backdrop.classList.add('hidden');
      }
    }

    mobileToggle.addEventListener('click', () => {
      if (sidebar.classList.contains('-translate-x-full')) {
        openMobileSidebar();
      } else {
        closeMobileSidebar();
      }
    });

    backdrop.addEventListener('click', closeMobileSidebar);

    // â”€â”€ Location (Dubai) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    const DUBAI_LAT = 25.2048;
    const DUBAI_LNG = 55.2708;

    // â”€â”€ Greeting & Date & Time â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function updateGreeting() {
      const hour = new Date().getHours();
      let greeting = 'Good evening';
      if (hour < 12) greeting = 'Good morning';
      else if (hour < 17) greeting = 'Good afternoon';
      document.getElementById('greeting').textContent = greeting;
    }

    function updateDate() {
      const now = new Date();
      const options = { weekday: 'short', day: 'numeric', month: 'short', year: 'numeric' };
      document.getElementById('current-date').textContent = now.toLocaleDateString('en-GB', options);
    }

    function updateTime() {
      const now = new Date();
      const timeStr = now.toLocaleTimeString('en-GB', { hour: '2-digit', minute: '2-digit', timeZone: 'Asia/Dubai' });
      document.getElementById('current-time').textContent = timeStr;
    }

    // â”€â”€ Weather (Open-Meteo â€” free, no API key) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    const WMO_CODES = {
      0: ['â˜€ï¸', 'Clear sky'], 1: ['ðŸŒ¤', 'Mainly clear'], 2: ['â›…', 'Partly cloudy'], 3: ['â˜ï¸', 'Overcast'],
      45: ['ðŸŒ«', 'Fog'], 48: ['ðŸŒ«', 'Rime fog'],
      51: ['ðŸŒ¦', 'Light drizzle'], 53: ['ðŸŒ¦', 'Drizzle'], 55: ['ðŸŒ§', 'Heavy drizzle'],
      61: ['ðŸŒ§', 'Light rain'], 63: ['ðŸŒ§', 'Rain'], 65: ['ðŸŒ§', 'Heavy rain'],
      71: ['ðŸŒ¨', 'Light snow'], 73: ['ðŸŒ¨', 'Snow'], 75: ['ðŸŒ¨', 'Heavy snow'],
      80: ['ðŸŒ¦', 'Showers'], 81: ['ðŸŒ§', 'Showers'], 82: ['â›ˆ', 'Heavy showers'],
      95: ['â›ˆ', 'Thunderstorm'], 96: ['â›ˆ', 'Thunderstorm + hail'], 99: ['â›ˆ', 'Heavy thunderstorm'],
    };

    async function fetchWeather() {
      try {
        const res = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${DUBAI_LAT}&longitude=${DUBAI_LNG}&current=temperature_2m,weather_code&timezone=Asia/Dubai`);
        const data = await res.json();
        const temp = Math.round(data.current.temperature_2m);
        const code = data.current.weather_code;
        const [icon, desc] = WMO_CODES[code] || ['ðŸŒ¡', 'Unknown'];
        document.getElementById('weather-icon').textContent = icon;
        document.getElementById('weather-temp').textContent = `${temp}Â°C`;
        document.getElementById('weather-desc').textContent = desc;
      } catch (e) {
        document.getElementById('weather-desc').textContent = 'Unavailable';
      }
    }

    // â”€â”€ Prayer Times (Aladhan API â€” free, no API key) â”€â”€â”€â”€
    async function fetchPrayerTimes() {
      try {
        const today = new Date();
        const dd = String(today.getDate()).padStart(2, '0');
        const mm = String(today.getMonth() + 1).padStart(2, '0');
        const yyyy = today.getFullYear();
        const res = await fetch(`https://api.aladhan.com/v1/timings/${dd}-${mm}-${yyyy}?latitude=${DUBAI_LAT}&longitude=${DUBAI_LNG}&method=16`);
        const data = await res.json();
        const timings = data.data.timings;

        const prayers = ['Fajr', 'Dhuhr', 'Asr', 'Maghrib', 'Isha'];
        const now = new Date();
        let nextFound = false;

        prayers.forEach(name => {
          const el = document.querySelector(`.prayer-time[data-prayer="${name}"]`);
          if (!el) return;
          const time = timings[name]; // "HH:MM" format
          el.textContent = `${name.slice(0, 3)} ${time}`;

          // Determine if passed or next
          const [h, m] = time.split(':').map(Number);
          const prayerDate = new Date(now);
          prayerDate.setHours(h, m, 0, 0);

          if (prayerDate < now) {
            el.classList.add('passed');
            el.classList.remove('active');
          } else if (!nextFound) {
            el.classList.add('active');
            el.classList.remove('passed');
            nextFound = true;
          }
        });
      } catch (e) {
        document.querySelectorAll('.prayer-time').forEach(el => {
          el.textContent = '--';
        });
      }
    }

    // â”€â”€ Init â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    window.addEventListener('hashchange', navigate);
    window.addEventListener('DOMContentLoaded', () => {
      updateGreeting();
      updateDate();
      updateTime();
      fetchWeather();
      fetchPrayerTimes();
      navigate();

      // Update time every 30 seconds
      setInterval(updateTime, 30000);
      // Refresh weather every 30 minutes
      setInterval(fetchWeather, 1800000);
    });

    // Handle responsive sidebar on resize
    window.addEventListener('resize', () => {
      if (window.innerWidth >= 768) {
        sidebar.classList.remove('-translate-x-full');
        backdrop.classList.add('hidden');
      } else {
        const isOnTool = (window.location.hash.slice(1) || 'home') !== 'home';
        if (!backdrop.classList.contains('hidden')) return; // already open
        sidebar.classList.add('-translate-x-full');
      }
    });
  </script>

</body>
</html>
